# Web性能优化

2021.3.22

## 后端

1. dns优化，配置host
   通过配置host可以减少查询服务器dns地址的时间。
2. keep-alive
   复用TCP连接而不需要重新建立，能减少TCP拥堵。
3. SQL优化
   根据network中请求的waiting时间判断后端是否需要数据库查询。
4. 压缩
   后端配置文件压缩为gzip，减少文件总大小，降低下载时间，浏览器收到压缩文件后会自行解压。
5. 提高服务器带宽（钞能力）
   提高带宽会增加服务器传输数据能力。
6. HTTP缓存
   将CSS、JS、图片等类型的文件设置为可http缓存，减少数据传输量。要注意，当文件内容发生改变时，为了让浏览器知道要请求新文件，通常在文件名中使用md5算法添加前缀或后缀，这样每次修改后文件名称不同，而浏览器会主动请求不同名的文件。
  
## 前端

1. 优化CSS
   合并重复选择器，合并CSS重复属性,可以使用第三方工具库完成。
2. 先加载CSS，再加载JS
   即将CSS文件在`<head>`中引入，将JS文件在`<body>`尾部引入。这样做可以先将页面渲染出来而不会因为JS加载被卡住。
3. 懒加载
   就是分屏加载。显示设备的宽度高度是一定的，先加载一部分在显示屏上，当有滑动、跳页时再用AJAX更新内容。
4. 预加载
   对于用户之后会进行的操作，先下载展示内容，发生相应操作时可以立即展示对应内容。
5. 加域名，可以同时发多个请求
   因为浏览器限制了同个域名下的请求次数，可以把资源放到不同的域名下，这样就能同时发出多个请求。
6. 减少重绘重排
   重绘：绘制DOM的内容、样式。
   重排：重新生成渲染树。
   尽量避免以上两种情况，不要使用Javascript直接修改样式，而是通过修改class；如果要对DOM元素进行复杂操作，可以先将元素隐藏，操作完成后再放回文档流。
7. 使用事件委托
   对于多数鼠标事件和键盘事件，可以将事件处理程序绑定到容器上，由于事件会向上冒泡，就不需要给容器内部元素额外绑定处理程序。可以节省内存。

